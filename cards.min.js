var cardSelectApp=function(){"use strict";function e(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var a=e.indexOf("rv:");return parseInt(e.substring(a+3,e.indexOf(".",a)),10)}var i=e.indexOf("Edge/");return i>0&&parseInt(e.substring(i+5,e.indexOf(".",i)),10)}function t(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}if("undefined"!=typeof jQuery)var a=jQuery;if(void 0===a)throw"jQuery required for the card picker game";var i,n={};return n.initialState=a("#cardSelectApp").html(),n.init=function(){if(a(window).resize(n.repositionGutter),"true"===t("backlink")||"y"===t("backlink")||"button"===t("backlink")){a("#cardSelectApp").addClass("backLinkActive");var d=n.resolveBacklinkURL(t("backlinkURL"));null!==d?a("#back-link").attr("href",d):a("#back-link").click(n.navBack),"button"===t("backlink")?a("#back-link").addClass("buttonStyle"):a("#back-link").addClass("linkStyle")}i=1;var l=0;a(".phase1").show(),a(".phase2").hide(),a(".card").each(function(){a(this).on("click",function(){a(this);l+=1,a(this).find("img").wrap("<div class='selectedCard' id='selected_"+l+"'></div>");var t=a(this).find(".selectedCard"),i=t.offset();console.log(i),i.top=i.top-a(document).scrollTop(),i.left=i.left-a(document).scrollLeft(),t.css("top",i.top),t.css("left",i.left),t.addClass("animated"),!1===e()||e()>11?1===l?t.animate({top:"90vh",left:n.getGutterOffset(t,0)},{complete:function(){n.addCardFlipFaces(t)}}):2===l?(n.flipCard(1),t.animate({top:"90vh",left:n.getGutterOffset(t,1)},{complete:function(){n.addCardFlipFaces(t)}})):3===l&&(n.flipCard(2),t.animate({top:"90vh",left:n.getGutterOffset(t,2)},{complete:function(){n.addCardFlipFaces(t)}}),n.phase2()):1===l?(t.css({bottom:"-150px",top:"",left:n.getGutterOffset(t)-400}),n.addCardFlipFaces(t)):2===l?(n.flipCard(1),t.css({bottom:"-150px",top:"",left:n.getGutterOffset(t)}),n.addCardFlipFaces(t)):3===l&&(n.flipCard(2),t.css({bottom:"-150px",top:"",left:n.getGutterOffset(t)+400}),n.addCardFlipFaces(t),n.phase2())})})},n.addCardFlipFaces=function(e){e.find("img").wrap("<div class='cardFront'></div>"),e.find(".cardFront").after("<div class='cardBack'></div>")},n.resolveBacklinkURL=function(e){if(null===e)return null;try{return new URL(e).href}catch(t){return"//"===e.substr(0,2)?new URL(window.location.protocol+e).href:-1===e.search(".")?e:"http"!==e.substr(0,4)?new URL(window.location.protocol+"//"+e).href:e}},n.repositionGutter=function(e,t,a){var i;return function(){var n=this,d=arguments,l=a&&!i;clearTimeout(i),i=setTimeout(function(){i=null,a||e.apply(n,d)},t),l&&e.apply(n,d)}}(function(){console.log("called");var e=a(".phase1 #selected_1"),t=a(".phase1 #selected_2"),i=a(".phase1 #selected_3");console.log(e),console.log(t),console.log(i),e.css("left",n.getGutterOffset(e,0)),t.css("left",n.getGutterOffset(t,1)),i.css("left",n.getGutterOffset(i,2))},250),n.getGutterOffset=function(e,t){var i=a(document).width()/2-e.width()/2,n=0,d=0;return 0===t?n=-1:2===t&&(n=1),d=a(document).width()>1050?400:a(document).width()>750?250:180,i+d*n},n.phase2=function(){a(".card").off(),a("div.phase1").delay(1e3).fadeOut(400,function(){a(".descriptionText").hide(),a("#text1").show(),a("div.phase2").fadeIn(),n.flipCard(3),a(".phase1 .selectedCard").hide().addClass("card").attr("style","");var e=a(".phase1 #selected_1"),t=a(".phase1 #selected_2"),i=a(".phase1 #selected_3");a(".selectedCard").hide(),e.appendTo("div.phase2 .cardContainer"),e.slideDown(500),t.insertAfter(e),t.slideDown(500),i.insertAfter(t),i.slideDown(500),a("div.selectedCard").on("click",n.clickNextCard),a("div.selectedCard:nth-child(1) .cardBack").after("<p>Past</p>"),a("div.selectedCard:nth-child(2) .cardBack").after("<p>Present</p>"),a("div.selectedCard:nth-child(3) .cardBack").after("<p>Future</p>"),a("div.selectedCard:nth-child(1)").toggleClass("nextClickable")})},n.next=function(){if(void 0===i&&(i=0),1===i?(n.flipCard(1),a("div.selectedCard:nth-child(1)").toggleClass("nextClickable"),a("div.selectedCard:nth-child(2)").toggleClass("nextClickable")):2===i?(n.flipCard(1),n.flipCard(2),a("div.selectedCard:nth-child(2)").toggleClass("nextClickable"),a("div.selectedCard:nth-child(3)").toggleClass("nextClickable")):3===i?(n.flipCard(2),n.flipCard(3),a("#nextButton").text("Show All"),a("#nextButton").text("Show All")):4===i&&(a("div.selectedCard:nth-child(3)").toggleClass("nextClickable"),n.flipCard(1),n.flipCard(2),a("a#nextButton").hide()),i<6){var e=a("#text"+(i-1)),t=a("#text"+i);e.css("height",0),e.length?e.fadeOut(function(){t.fadeIn()}):t.fadeIn(),i++}},n.clickNextCard=function(){a(this).hasClass("nextClickable")&&n.next()},n.flipCard=function(e){a("#selected_"+e).toggleClass("flipped")},n.reset=function(){var e=a("#cardSelectApp");e.fadeOut(100),window.setTimeout(function(){e.html(""),window.setTimeout(function(){e.html(n.initialState),window.setTimeout(function(){n.init(),e.fadeIn()},300)},300)},200)},n.navBack=function(){window.history.back()},n}();$(window).on("load",cardSelectApp.init());